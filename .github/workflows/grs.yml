name: Update README cards

on:
  schedule:
    - cron: "0 0 * * *"          # 每天 UTC 00:00 执行（北京时间早上8点或9点）
  workflow_dispatch:             # 允许手动触发

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write            # 必须有写入权限

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}   # 通常用这个就够（公开仓库）

      # ─── 生成 Stats 卡片 ───
      - name: Generate Stats Card
        uses: stats-organization/github-readme-stats-action@v1
        with:
          card: stats
          options: |
            username=${{ github.repository_owner }}
            show_icons=true
            theme=radical           # 可换：tokyonight, dracula, onedark, synthwave, etc.
            hide=prs,issues         # 可选：隐藏不想显示的项目
            hide_title=true
            card_width=500

      # ─── 生成 Top Languages 卡片 ───
      - name: Generate Top Languages Card
        uses: stats-organization/github-readme-stats-action@v1
        with:
          card: top-langs
          options: |
            username=${{ github.repository_owner }}
            show_icons=true
            theme=radical
            layout=compact
            langs_count=8
            hide=html,css,tex,jupyter%20notebook  # 可隐藏不想显示的语言

      # ─── （可选）生成 Pinned 项目卡片 ───
      # - name: Generate Pinned Card
      #   uses: stats-organization/github-readme-stats-action@v1
      #   with:
      #     card: pin
      #     options: |
      #       username=${{ github.repository_owner }}
      #       repo=github-readme-stats,gitprofile,...
      #       theme=radical

      # ─── 提交生成的 SVG 文件 ───
      - name: Commit changed files
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add -A
          git commit -m "chore: update stats cards [skip ci]" || echo "No changes to commit"
          git push